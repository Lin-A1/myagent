# é¡¹ç›®æ¶æ„è¯´æ˜

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»äº† MyAgent é¡¹ç›®çš„æ•´ä½“æ¶æ„è®¾è®¡ã€æ¨¡å—ç»„ç»‡å’Œè®¾è®¡ç†å¿µã€‚

## ğŸ“‹ ç›®å½•

- [æ¶æ„æ¦‚è§ˆ](#æ¶æ„æ¦‚è§ˆ)
- [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
- [æ ¸å¿ƒæ¨¡å—](#æ ¸å¿ƒæ¨¡å—)
- [è®¾è®¡åŸåˆ™](#è®¾è®¡åŸåˆ™)
- [æ•°æ®æµ](#æ•°æ®æµ)
- [æ‰©å±•æ€§è®¾è®¡](#æ‰©å±•æ€§è®¾è®¡)
- [æœªæ¥è§„åˆ’](#æœªæ¥è§„åˆ’)

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

MyAgent é‡‡ç”¨æ¨¡å—åŒ–ã€åˆ†å±‚çš„æ¶æ„è®¾è®¡ï¼Œæ—¨åœ¨æä¾›ä¸€ä¸ªå¯æ‰©å±•ã€æ˜“ç»´æŠ¤çš„æ™ºèƒ½ä»£ç†å¼€å‘æ¡†æ¶ã€‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åº”ç”¨å±‚ (Examples)                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æœåŠ¡å±‚ (Server)                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    æ¨¡å—å±‚ (Modules)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚    Agent    â”‚  Knowledge  â”‚     RAG     â”‚   MCP    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    å¼•æ“å±‚ (Engines)                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚     LLM     â”‚   Vector    â”‚   Search    â”‚  Memory  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    åŸºç¡€å±‚ (Base)                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Logger    â”‚   Config    â”‚   Utils     â”‚   Types  â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¶æ„å±‚æ¬¡è¯´æ˜

1. **åº”ç”¨å±‚**: å…·ä½“çš„åº”ç”¨å®ä¾‹å’Œç¤ºä¾‹ä»£ç 
2. **æœåŠ¡å±‚**: Web æœåŠ¡ã€API æ¥å£ç­‰æœåŠ¡ç»„ä»¶
3. **æ¨¡å—å±‚**: é«˜çº§åŠŸèƒ½æ¨¡å—ï¼Œå¦‚æ™ºèƒ½ä»£ç†ã€çŸ¥è¯†åº“ç­‰
4. **å¼•æ“å±‚**: æ ¸å¿ƒå¼•æ“ç»„ä»¶ï¼Œå¦‚ LLMã€å‘é‡æ•°æ®åº“ç­‰
5. **åŸºç¡€å±‚**: åŸºç¡€è®¾æ–½ç»„ä»¶ï¼Œå¦‚æ—¥å¿—ã€é…ç½®ç®¡ç†ç­‰

## ğŸ“ ç›®å½•ç»“æ„

```
myagent/
â”œâ”€â”€ src/                          # æºä»£ç æ ¹ç›®å½•
â”‚   â”œâ”€â”€ __init__.py              # åŒ…åˆå§‹åŒ–æ–‡ä»¶
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ base/                # åŸºç¡€ç»„ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”‚   â”œâ”€â”€ logger.py        # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”‚   â”‚   â”œâ”€â”€ config.py        # é…ç½®ç®¡ç† (è§„åˆ’ä¸­)
â”‚   â”‚   â”‚   â””â”€â”€ utils.py         # å·¥å…·å‡½æ•° (è§„åˆ’ä¸­)
â”‚   â”‚   â””â”€â”€ engines/             # å¼•æ“æ¨¡å—
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ llm/             # LLM å¼•æ“
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â””â”€â”€ base.py      # LLM åŸºç¡€ç±»
â”‚   â”‚       â”œâ”€â”€ ocr/             # OCR å¼•æ“
â”‚   â”‚       â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚       â”‚   â””â”€â”€ base.py      # OCR åŸºç¡€ç±»
â”‚   â”‚       â”œâ”€â”€ vector/          # å‘é‡æ•°æ®åº“å¼•æ“ (è§„åˆ’ä¸­)
â”‚   â”‚       â”œâ”€â”€ search/          # æœç´¢å¼•æ“ (è§„åˆ’ä¸­)
â”‚   â”‚       â””â”€â”€ memory/          # è®°å¿†å¼•æ“ (è§„åˆ’ä¸­)
â”‚   â”œâ”€â”€ modules/                 # åŠŸèƒ½æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ agent/               # æ™ºèƒ½ä»£ç†æ¨¡å— (è§„åˆ’ä¸­)
â”‚   â”‚   â”œâ”€â”€ knowledge/           # çŸ¥è¯†åº“æ¨¡å— (è§„åˆ’ä¸­)
â”‚   â”‚   â”œâ”€â”€ rag/                 # RAG æ¨¡å— (è§„åˆ’ä¸­)
â”‚   â”‚   â””â”€â”€ mcp/                 # MCP åè®®æ¨¡å— (è§„åˆ’ä¸­)
â”‚   â”œâ”€â”€ server/                  # æœåŠ¡å™¨æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ main.py              # FastAPI ä¸»åº”ç”¨
â”‚   â”‚   â”œâ”€â”€ run_server.py        # æœåŠ¡å™¨å¯åŠ¨è„šæœ¬
â”‚   â”‚   â””â”€â”€ routes/              # API è·¯ç”±
â”‚   â”‚       â”œâ”€â”€ __init__.py
â”‚   â”‚       â”œâ”€â”€ llm.py           # LLM API è·¯ç”±
â”‚   â”‚       â””â”€â”€ ocr.py           # OCR API è·¯ç”±
â”‚   â”œâ”€â”€ client/                  # å®¢æˆ·ç«¯æ¨¡å— (è§„åˆ’ä¸­)
â”‚   â”œâ”€â”€ common/                  # é€šç”¨èµ„æº
â”‚   â”‚   â”œâ”€â”€ audio/               # éŸ³é¢‘å¤„ç† (è§„åˆ’ä¸­)
â”‚   â”‚   â”œâ”€â”€ images/              # å›¾åƒå¤„ç† (è§„åˆ’ä¸­)
â”‚   â”‚   â””â”€â”€ video/               # è§†é¢‘å¤„ç† (è§„åˆ’ä¸­)
â”‚   â””â”€â”€ db/                      # æ•°æ®åº“æ¨¡å— (è§„åˆ’ä¸­)
â”œâ”€â”€ examples/                    # ç¤ºä¾‹ä»£ç 
â”‚   â”œâ”€â”€ llm_chat.py             # LLM èŠå¤©ç¤ºä¾‹
â”‚   â””â”€â”€ ocr_demo.py             # OCR è¯†åˆ«ç¤ºä¾‹
â”œâ”€â”€ docs/                        # æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ README.md               # ä¸»æ–‡æ¡£
â”‚   â”œâ”€â”€ llm-guide.md            # LLM ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ ocr-guide.md            # OCR ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ api-reference.md        # API å‚è€ƒ
â”‚   â”œâ”€â”€ quick-start.md          # å¿«é€Ÿå¼€å§‹
â”‚   â””â”€â”€ architecture.md         # æ¶æ„è¯´æ˜ (æœ¬æ–‡æ¡£)
â”œâ”€â”€ conf/                        # é…ç½®æ–‡ä»¶ç›®å½•
â”œâ”€â”€ tests/                       # æµ‹è¯•æ–‡ä»¶ (è§„åˆ’ä¸­)
â”œâ”€â”€ requirements.txt             # Python ä¾èµ–
â”œâ”€â”€ pyproject.toml              # é¡¹ç›®é…ç½®
â”œâ”€â”€ .gitignore                  # Git å¿½ç•¥æ–‡ä»¶
â””â”€â”€ README.md                   # é¡¹ç›®è¯´æ˜
```

## ğŸ”§ æ ¸å¿ƒæ¨¡å—

### 1. åŸºç¡€å±‚ (Core/Base)

#### Logger æ¨¡å—

**ä½ç½®**: `src/core/base/logger.py`

**åŠŸèƒ½**:
- ç»Ÿä¸€çš„æ—¥å¿—ç®¡ç†
- å¤šçº§åˆ«æ—¥å¿—è¾“å‡º
- æ–‡ä»¶å’Œæ§åˆ¶å°åŒé‡è¾“å‡º
- æ—¥å¿—è½®è½¬å’Œå½’æ¡£

**è®¾è®¡ç‰¹ç‚¹**:
```python
# å•ä¾‹æ¨¡å¼ç¡®ä¿å…¨å±€ç»Ÿä¸€
logger = get_logger("ModuleName")

# æ”¯æŒå¤šç§æ—¥å¿—çº§åˆ«
logger.debug("è°ƒè¯•ä¿¡æ¯")
logger.info("ä¸€èˆ¬ä¿¡æ¯")
logger.warning("è­¦å‘Šä¿¡æ¯")
logger.error("é”™è¯¯ä¿¡æ¯")
```

#### Config æ¨¡å— (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- é…ç½®æ–‡ä»¶ç®¡ç†
- ç¯å¢ƒå˜é‡å¤„ç†
- åŠ¨æ€é…ç½®æ›´æ–°
- é…ç½®éªŒè¯

#### Utils æ¨¡å— (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- é€šç”¨å·¥å…·å‡½æ•°
- æ•°æ®å¤„ç†å·¥å…·
- æ–‡ä»¶æ“ä½œå·¥å…·
- ç½‘ç»œå·¥å…·

### 2. å¼•æ“å±‚ (Core/Engines)

#### LLM å¼•æ“

**ä½ç½®**: `src/core/engines/llm/base.py`

**åŠŸèƒ½**:
- ç»Ÿä¸€çš„ LLM æ¥å£
- å¤šæ¨¡å‹æ”¯æŒ (OpenAI, DashScope, è‡ªå®šä¹‰ç«¯ç‚¹)
- å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†
- å‰ç«¯é…ç½®æ”¯æŒ

**è®¾è®¡ç‰¹ç‚¹**:
```python
class LLM:
    """LLM å¼•æ“åŸºç±»"""
    
    def __init__(self, model="gpt-3.5-turbo", api_key=None, base_url=None):
        """åˆå§‹åŒ–é…ç½® - api_key ç°åœ¨æ˜¯å¿…éœ€å‚æ•°"""
        if not api_key:
            raise ValueError("api_key is required")
        
    def chat(self, user_input, system_prompt=None, keep_context=True, temperature=0.7):
        """ç»Ÿä¸€çš„å¯¹è¯æ¥å£"""
        
    def clear_context(self):
        """æ¸…ç©ºå¯¹è¯ä¸Šä¸‹æ–‡"""
        
    def get_context(self):
        """è·å–å½“å‰å¯¹è¯ä¸Šä¸‹æ–‡"""
        
    def set_context(self, context):
        """è®¾ç½®å¯¹è¯ä¸Šä¸‹æ–‡"""
```

**é‡è¦å˜æ›´**:
- API å¯†é’¥ç°åœ¨æ˜¯å¿…éœ€å‚æ•°ï¼Œä¸å†ä»ç¯å¢ƒå˜é‡è‡ªåŠ¨è¯»å–
- æ”¯æŒå‰ç«¯åŠ¨æ€é…ç½® (é€šè¿‡ REST API)
- ç§»é™¤äº†å…¨å±€ LLM å®ä¾‹çš„ä¾èµ–
- å¢å¼ºäº†é”™è¯¯å¤„ç†å’Œå‚æ•°éªŒè¯

#### OCR å¼•æ“

**ä½ç½®**: `src/core/engines/ocr/base.py`

**åŠŸèƒ½**:
- å…‰å­¦å­—ç¬¦è¯†åˆ«
- å¤šç§è¾“å…¥æ ¼å¼æ”¯æŒ (æ–‡ä»¶è·¯å¾„ã€Base64ã€NumPy æ•°ç»„)
- ç»Ÿä¸€çš„è¯†åˆ«æ¥å£
- é”™è¯¯å¤„ç†å’Œæ—¥å¿—è®°å½•

**è®¾è®¡ç‰¹ç‚¹**:
```python
class OCR:
    """OCR å¼•æ“åŸºç±»"""
    
    def __init__(self):
        """åˆå§‹åŒ– OCR å¼•æ“"""
        
    def recognize(self, input_data):
        """ç»Ÿä¸€çš„è¯†åˆ«æ¥å£"""
        # æ”¯æŒå¤šç§è¾“å…¥æ ¼å¼
        # è¿”å›è¯†åˆ«ç»“æœ
```

#### Vector å¼•æ“ (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- å‘é‡æ•°æ®åº“é›†æˆ
- ç›¸ä¼¼åº¦æœç´¢
- å‘é‡ç´¢å¼•ç®¡ç†
- æ‰¹é‡å¤„ç†

#### Search å¼•æ“ (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- å…¨æ–‡æœç´¢
- è¯­ä¹‰æœç´¢
- æ··åˆæœç´¢
- æœç´¢ç»“æœæ’åº

#### Memory å¼•æ“ (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- é•¿æœŸè®°å¿†ç®¡ç†
- çŸ­æœŸè®°å¿†ç¼“å­˜
- è®°å¿†æ£€ç´¢
- è®°å¿†æ›´æ–°

### 3. æœåŠ¡å±‚ (Server)

#### FastAPI ä¸»åº”ç”¨

**ä½ç½®**: `src/server/main.py`

**åŠŸèƒ½**:
- FastAPI åº”ç”¨åˆå§‹åŒ–
- CORS ä¸­é—´ä»¶é…ç½®
- è·¯ç”±æ³¨å†Œ
- å¥åº·æ£€æŸ¥ç«¯ç‚¹

**è®¾è®¡ç‰¹ç‚¹**:
```python
app = FastAPI(
    title="MyAgent API",
    description="æ™ºèƒ½ä»£ç† API æœåŠ¡",
    version="1.0.0"
)

# æ³¨å†Œè·¯ç”±
app.include_router(llm_router, prefix="/llm", tags=["LLM"])
app.include_router(ocr_router, prefix="/ocr", tags=["OCR"])

# å¥åº·æ£€æŸ¥
@app.get("/health")
async def health_check():
    return {"status": "healthy", "services": {...}}
```

#### LLM API è·¯ç”±

**ä½ç½®**: `src/server/routes/llm.py`

**åŠŸèƒ½**:
- LLM èŠå¤©æ¥å£ (`POST /llm/chat`)
- ä¸Šä¸‹æ–‡ç®¡ç†æ¥å£ (`GET/POST/DELETE /llm/context`)
- æœåŠ¡ä¿¡æ¯æ¥å£ (`GET /llm/info`)
- å¥åº·æ£€æŸ¥æ¥å£ (`GET /llm/health`)

**è®¾è®¡ç‰¹ç‚¹**:
- ä½¿ç”¨ Pydantic æ¨¡å‹è¿›è¡Œè¯·æ±‚/å“åº”éªŒè¯
- æ”¯æŒå‰ç«¯é…ç½® (API å¯†é’¥ã€æ¨¡å‹ã€ç«¯ç‚¹)
- ç»Ÿä¸€çš„é”™è¯¯å¤„ç†
- è¯¦ç»†çš„ API æ–‡æ¡£

#### OCR API è·¯ç”±

**ä½ç½®**: `src/server/routes/ocr.py`

**åŠŸèƒ½**:
- OCR è¯†åˆ«æ¥å£
- å¤šç§è¾“å…¥æ ¼å¼æ”¯æŒ
- ç»“æœæ ¼å¼åŒ–
- é”™è¯¯å¤„ç†

### 3. æ¨¡å—å±‚ (Modules)

#### Agent æ¨¡å— (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- æ™ºèƒ½ä»£ç†æ¡†æ¶
- ä»»åŠ¡è§„åˆ’
- å·¥å…·è°ƒç”¨
- å¤šä»£ç†åä½œ

#### Knowledge æ¨¡å— (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- çŸ¥è¯†åº“æ„å»º
- çŸ¥è¯†å›¾è°±
- çŸ¥è¯†æ£€ç´¢
- çŸ¥è¯†æ›´æ–°

#### RAG æ¨¡å— (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- æ£€ç´¢å¢å¼ºç”Ÿæˆ
- æ–‡æ¡£å¤„ç†
- å‘é‡åŒ–
- ç­”æ¡ˆç”Ÿæˆ

#### MCP æ¨¡å— (è§„åˆ’ä¸­)

**åŠŸèƒ½**:
- MCP åè®®æ”¯æŒ
- å·¥å…·é›†æˆ
- èµ„æºç®¡ç†
- é€šä¿¡åè®®

## ğŸ¯ è®¾è®¡åŸåˆ™

### 1. æ¨¡å—åŒ–è®¾è®¡

- **å•ä¸€èŒè´£**: æ¯ä¸ªæ¨¡å—ä¸“æ³¨äºç‰¹å®šåŠŸèƒ½
- **æ¾è€¦åˆ**: æ¨¡å—é—´ä¾èµ–æœ€å°åŒ–
- **é«˜å†…èš**: æ¨¡å—å†…éƒ¨åŠŸèƒ½ç´§å¯†ç›¸å…³

### 2. åˆ†å±‚æ¶æ„

- **æ¸…æ™°åˆ†å±‚**: ä¸åŒå±‚æ¬¡æ‰¿æ‹…ä¸åŒèŒè´£
- **ä¾èµ–æ–¹å‘**: ä¸Šå±‚ä¾èµ–ä¸‹å±‚ï¼Œé¿å…å¾ªç¯ä¾èµ–
- **æ¥å£æŠ½è±¡**: å±‚é—´é€šè¿‡æ¥å£äº¤äº’

### 3. å¯æ‰©å±•æ€§

- **æ’ä»¶åŒ–**: æ”¯æŒåŠŸèƒ½æ¨¡å—çš„åŠ¨æ€åŠ è½½
- **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶è¡Œä¸º
- **æ¥å£æ ‡å‡†**: ç»Ÿä¸€çš„æ¥å£è§„èŒƒ

### 4. å¯ç»´æŠ¤æ€§

- **ä»£ç è§„èŒƒ**: éµå¾ª PEP 8 å’Œé¡¹ç›®è§„èŒƒ
- **æ–‡æ¡£å®Œå–„**: è¯¦ç»†çš„ä»£ç æ–‡æ¡£å’Œä½¿ç”¨è¯´æ˜
- **æµ‹è¯•è¦†ç›–**: é«˜è´¨é‡çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### 5. æ€§èƒ½ä¼˜åŒ–

- **å¼‚æ­¥å¤„ç†**: ä½¿ç”¨ async/await æé«˜å¹¶å‘æ€§èƒ½
- **ç¼“å­˜æœºåˆ¶**: åˆç†ä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
- **èµ„æºç®¡ç†**: æœ‰æ•ˆç®¡ç†å†…å­˜å’Œç½‘ç»œèµ„æº

## ğŸ”„ æ•°æ®æµ

### 1. Python SDK å¯¹è¯æµç¨‹

```mermaid
sequenceDiagram
    participant User as ç”¨æˆ·
    participant App as åº”ç”¨å±‚
    participant LLM as LLMå¼•æ“
    participant API as å¤–éƒ¨API
    participant Logger as æ—¥å¿—ç³»ç»Ÿ

    User->>App: å‘é€æ¶ˆæ¯
    App->>Logger: è®°å½•è¯·æ±‚
    Note over App: æ˜¾å¼æä¾› API å¯†é’¥
    App->>LLM: è°ƒç”¨ chat(api_key=key)
    LLM->>Logger: è®°å½•è°ƒç”¨ä¿¡æ¯
    LLM->>API: å‘é€ API è¯·æ±‚
    API-->>LLM: è¿”å›å“åº”
    LLM->>Logger: è®°å½•å“åº”ä¿¡æ¯
    LLM-->>App: è¿”å›ç»“æœ
    App->>Logger: è®°å½•ç»“æœ
    App-->>User: è¿”å›å›å¤
```

### 2. REST API å¯¹è¯æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Server as FastAPIæœåŠ¡å™¨
    participant Route as LLMè·¯ç”±
    participant LLM as LLMå¼•æ“
    participant API as å¤–éƒ¨API

    Client->>Server: POST /llm/chat
    Note over Client,Server: åŒ…å«é…ç½® (api_key, model)
    Server->>Route: è·¯ç”±è¯·æ±‚
    Route->>Route: éªŒè¯è¯·æ±‚å‚æ•°
    Route->>LLM: åˆ›å»ºä¸´æ—¶å®ä¾‹
    LLM->>API: å‘é€ API è¯·æ±‚
    API-->>LLM: è¿”å›å“åº”
    LLM-->>Route: è¿”å›ç»“æœ
    Route-->>Server: æ ¼å¼åŒ–å“åº”
    Server-->>Client: è¿”å› JSON å“åº”
```

### 3. ä¸Šä¸‹æ–‡ç®¡ç†æµç¨‹

```mermaid
graph TD
    A[ç”¨æˆ·è¾“å…¥] --> B[æ£€æŸ¥ç³»ç»Ÿæç¤º]
    B --> C[æ·»åŠ åˆ°ä¸Šä¸‹æ–‡]
    C --> D{ä½¿ç”¨æ–¹å¼}
    D -->|Python SDK| E[è°ƒç”¨ LLM.chat()]
    D -->|REST API| F[POST /llm/chat]
    E --> G[è°ƒç”¨ LLM API]
    F --> H[åˆ›å»ºä¸´æ—¶ LLM å®ä¾‹]
    H --> G
    G --> I{API è°ƒç”¨æˆåŠŸ?}
    I -->|æ˜¯| J[æ·»åŠ å›å¤åˆ°ä¸Šä¸‹æ–‡]
    I -->|å¦| K[å›æ»šç”¨æˆ·æ¶ˆæ¯]
    J --> L[è¿”å›å›å¤]
    K --> M[æŠ›å‡ºå¼‚å¸¸]
```

### 4. å¥åº·æ£€æŸ¥æµç¨‹

```mermaid
graph LR
    A[GET /health] --> B[æ£€æŸ¥ OCR æœåŠ¡]
    B --> C[æ£€æŸ¥ LLM æœåŠ¡]
    C --> D{æ‰€æœ‰æœåŠ¡æ­£å¸¸?}
    D -->|æ˜¯| E[è¿”å› healthy]
    D -->|å¦| F[è¿”å› degraded]
    F --> G[åŒ…å«é”™è¯¯è¯¦æƒ…]
```

### 5. é…ç½®ç®¡ç†æµç¨‹

```mermaid
graph TD
    A[å®¢æˆ·ç«¯è¯·æ±‚] --> B{ä½¿ç”¨æ–¹å¼}
    B -->|Python SDK| C[ç›´æ¥ä¼ å…¥é…ç½®]
    B -->|REST API| D[è¯·æ±‚ä½“åŒ…å«é…ç½®]
    C --> E[LLM(api_key=key)]
    D --> F[è§£æ LLMConfig]
    F --> G[åˆ›å»ºä¸´æ—¶ LLM å®ä¾‹]
    E --> H[æ‰§è¡Œæ“ä½œ]
    G --> H
    H --> I[è¿”å›ç»“æœ]
```

## ğŸš€ æ‰©å±•æ€§è®¾è®¡

### 1. å¼•æ“æ‰©å±•

#### LLM å¼•æ“æ‰©å±•
- **å¤šæ¨¡å‹æ”¯æŒ**: é€šè¿‡ç»Ÿä¸€æ¥å£æ”¯æŒ OpenAIã€DashScope ç­‰å¤šç§ LLM æœåŠ¡
- **é…ç½®çµæ´»æ€§**: æ”¯æŒè¿è¡Œæ—¶é…ç½®ï¼Œæ— éœ€å…¨å±€è®¾ç½®
- **é”™è¯¯å¤„ç†**: ç»Ÿä¸€çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤æœºåˆ¶
- **ä¸Šä¸‹æ–‡ç®¡ç†**: çµæ´»çš„å¯¹è¯ä¸Šä¸‹æ–‡ç®¡ç†ç­–ç•¥

```python
# æ‰©å±•æ–°çš„ LLM æä¾›å•†
class CustomLLMProvider:
    def __init__(self, api_key: str, base_url: str):
        self.api_key = api_key
        self.base_url = base_url
    
    def chat(self, messages: List[Dict], **kwargs):
        # å®ç°è‡ªå®šä¹‰ LLM è°ƒç”¨é€»è¾‘
        pass
```

#### OCR å¼•æ“æ‰©å±•
- **å¤šè¾“å…¥æ ¼å¼**: æ”¯æŒæ–‡ä»¶è·¯å¾„ã€Base64ã€NumPy æ•°ç»„ç­‰å¤šç§è¾“å…¥
- **ç»“æœæ ¼å¼åŒ–**: ç»Ÿä¸€çš„ OCR ç»“æœæ ¼å¼
- **æ€§èƒ½ä¼˜åŒ–**: æ”¯æŒæ‰¹é‡å¤„ç†å’Œå¼‚æ­¥æ“ä½œ

### 2. æœåŠ¡å™¨æ‰©å±•

#### API è·¯ç”±æ‰©å±•
```python
# æ·»åŠ æ–°çš„ API è·¯ç”±
from fastapi import APIRouter

router = APIRouter(prefix="/custom", tags=["custom"])

@router.post("/endpoint")
async def custom_endpoint(request: CustomRequest):
    # å®ç°è‡ªå®šä¹‰é€»è¾‘
    return {"result": "success"}
```

#### ä¸­é—´ä»¶æ‰©å±•
```python
# æ·»åŠ è‡ªå®šä¹‰ä¸­é—´ä»¶
from fastapi import Request
from starlette.middleware.base import BaseHTTPMiddleware

class CustomMiddleware(BaseHTTPMiddleware):
    async def dispatch(self, request: Request, call_next):
        # é¢„å¤„ç†
        response = await call_next(request)
        # åå¤„ç†
        return response
```

### 3. é…ç½®æ‰©å±•

#### ç¯å¢ƒé…ç½®
- **å¤šç¯å¢ƒæ”¯æŒ**: å¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ç¯å¢ƒé…ç½®åˆ†ç¦»
- **åŠ¨æ€é…ç½®**: æ”¯æŒè¿è¡Œæ—¶é…ç½®æ›´æ–°
- **é…ç½®éªŒè¯**: ä½¿ç”¨ Pydantic è¿›è¡Œé…ç½®éªŒè¯

```python
from pydantic import BaseSettings

class CustomConfig(BaseSettings):
    custom_api_key: str
    custom_endpoint: str
    
    class Config:
        env_file = ".env"
```

#### æ¨¡å‹é…ç½®
- **æ¨¡å‹å‚æ•°**: æ”¯æŒè‡ªå®šä¹‰æ¨¡å‹å‚æ•°ï¼ˆtemperatureã€max_tokens ç­‰ï¼‰
- **æä¾›å•†é…ç½®**: æ”¯æŒå¤šä¸ª LLM æä¾›å•†çš„é…ç½®
- **é»˜è®¤å€¼ç®¡ç†**: åˆç†çš„é»˜è®¤é…ç½®å’Œè¦†ç›–æœºåˆ¶

### 4. å®¢æˆ·ç«¯æ‰©å±•

#### Python SDK æ‰©å±•
```python
# æ‰©å±• LLM ç±»åŠŸèƒ½
class ExtendedLLM(LLM):
    def __init__(self, api_key: str, **kwargs):
        super().__init__(api_key, **kwargs)
        self.custom_features = {}
    
    def custom_method(self, **kwargs):
        # å®ç°è‡ªå®šä¹‰åŠŸèƒ½
        pass
```

#### REST API å®¢æˆ·ç«¯
```javascript
// JavaScript å®¢æˆ·ç«¯æ‰©å±•
class MyAgentClient {
    constructor(baseUrl) {
        this.baseUrl = baseUrl;
    }
    
    async customRequest(endpoint, data) {
        // å®ç°è‡ªå®šä¹‰è¯·æ±‚é€»è¾‘
        return fetch(`${this.baseUrl}${endpoint}`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        });
    }
}
```

### 5. æ’ä»¶ç³»ç»Ÿï¼ˆè§„åˆ’ä¸­ï¼‰

#### æ’ä»¶æ¥å£
```python
from abc import ABC, abstractmethod

class Plugin(ABC):
    @abstractmethod
    def initialize(self, config: dict):
        """åˆå§‹åŒ–æ’ä»¶"""
        pass
    
    @abstractmethod
    def process(self, data: Any) -> Any:
        """å¤„ç†æ•°æ®"""
        pass
```

#### æ’ä»¶ç®¡ç†å™¨
```python
class PluginManager:
    def __init__(self):
        self.plugins = {}
    
    def register_plugin(self, name: str, plugin: Plugin):
        """æ³¨å†Œæ’ä»¶"""
        self.plugins[name] = plugin
    
    def execute_plugin(self, name: str, data: Any):
        """æ‰§è¡Œæ’ä»¶"""
        return self.plugins[name].process(data)
```

## ğŸ“ˆ æœªæ¥è§„åˆ’

### çŸ­æœŸç›®æ ‡ (1-3 ä¸ªæœˆ)

1. **å®Œå–„ LLM å¼•æ“**
   - æ”¯æŒæ›´å¤šæ¨¡å‹æä¾›å•†
   - æ·»åŠ æµå¼è¾“å‡º
   - ä¼˜åŒ–é”™è¯¯å¤„ç†

2. **æ·»åŠ é…ç½®ç®¡ç†**
   - é…ç½®æ–‡ä»¶æ”¯æŒ
   - ç¯å¢ƒå˜é‡ç®¡ç†
   - åŠ¨æ€é…ç½®æ›´æ–°

3. **åŸºç¡€å·¥å…·æ¨¡å—**
   - æ–‡ä»¶å¤„ç†å·¥å…·
   - ç½‘ç»œè¯·æ±‚å·¥å…·
   - æ•°æ®å¤„ç†å·¥å…·

### ä¸­æœŸç›®æ ‡ (3-6 ä¸ªæœˆ)

1. **å‘é‡æ•°æ®åº“å¼•æ“**
   - æ”¯æŒ Faissã€Chroma
   - å‘é‡ç´¢å¼•ç®¡ç†
   - ç›¸ä¼¼åº¦æœç´¢

2. **RAG æ¨¡å—**
   - æ–‡æ¡£å¤„ç†
   - å‘é‡åŒ–
   - æ£€ç´¢å¢å¼ºç”Ÿæˆ

3. **Web æœåŠ¡**
   - FastAPI æ¥å£
   - WebSocket æ”¯æŒ
   - API æ–‡æ¡£

### é•¿æœŸç›®æ ‡ (6-12 ä¸ªæœˆ)

1. **æ™ºèƒ½ä»£ç†æ¡†æ¶**
   - ä»»åŠ¡è§„åˆ’
   - å·¥å…·è°ƒç”¨
   - å¤šä»£ç†åä½œ

2. **çŸ¥è¯†åº“ç³»ç»Ÿ**
   - çŸ¥è¯†å›¾è°±
   - çŸ¥è¯†æ£€ç´¢
   - çŸ¥è¯†æ›´æ–°

3. **MCP åè®®æ”¯æŒ**
   - å·¥å…·é›†æˆ
   - èµ„æºç®¡ç†
   - æ ‡å‡†åŒ–æ¥å£

## ğŸ”— ç›¸å…³èµ„æº

- [è®¾è®¡æ¨¡å¼å‚è€ƒ](https://refactoring.guru/design-patterns)
- [Python æ¶æ„æŒ‡å—](https://docs.python-guide.org/)
- [FastAPI æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [å¼‚æ­¥ç¼–ç¨‹æŒ‡å—](https://docs.python.org/3/library/asyncio.html)

---

æœ¬æ¶æ„æ–‡æ¡£ä¼šéšç€é¡¹ç›®å‘å±•æŒç»­æ›´æ–°ï¼Œæ¬¢è¿æå‡ºå»ºè®®å’Œæ”¹è¿›æ„è§ã€‚